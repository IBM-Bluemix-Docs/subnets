---
copyright:
  years: 1994, 2017, 2018, 2019
lastupdated: "2018-02-28"

keywords: Ms IP addresses, Use Secondary Subnets, own virtual machines

subcollection: subnets

---
{:shortdesc: .shortdesc}
{:new_window: target="_blank"}

# 自己ホスト VM でのセカンダリー・サブネットの使用
{:#use-secondary-subnets-self-hosted-vms}

独自の仮想マシンをホストし、それらの仮想マシンを {{site.data.keyword.BluSoftlayer_notm}} ネットワークの第一級オブジェクトにしたい場合は、**セカンダリー・サブネット**を使用する必要があります。ここでは、クラスター構成の一部かどうかにかかわらず、1 つ以上の仮想マシン・ホストを使用している場合に VM に IP アドレスを柔軟に提供できる方法について説明します。

このシナリオに何度も出てくるサブネットのタイプについて詳細を知りたくなった場合は、[サブネットについて](/docs/infrastructure/subnets?topic=subnets-about-subnets-and-ips)を参照してください。

`aunt` および `uncle` という 2 つのベアメタル・サーバーがあるとします。どちらもお客様独自の仮想マシンのホストになる予定で、既に同じ**プライマリー・サブネット**から IP アドレスを割り当てられています。仮想マシン用に追加の IP アドレスが必要です。この目的には、任意のタイプのセカンダリー・サブネットを使用できますが、VM で使用するアドレスのソースには**ポータブル・セカンダリー・サブネット**を使用することをお勧めします。ポータブル・サブネットであれば、`aunt` および `uncle` のどちらも、そのサブネットで定義された IP アドレスを利用できます。このように IP アドレスを両方のサーバーで共有できるので、VM にマイグレーション手法を使用する場合には、VM をそれらのサーバー間でシームレスに転送できます。

ここで、2 つの仮想マシン `VPS1` および `VPS2` を作成し、ポータブル・サブネット 129.42.0.0/29 を購入し、そこから 2 つのアドレスを仮想マシンに割り当てたとします。IP アドレスの使用状況は以下のようになります。

129.42.0.0/29 - ポータブル・セカンダリー・サブネット
```
129.42.0.0 – ネットワーク
129.42.0.1 – ゲートウェイ
129.42.0.2 –
129.42.0.3 – VPS1
129.42.0.4 –
129.42.0.5 – VPS2
129.42.0.6 –
129.42.0.7 – ブロードキャスト
```

次は、提供するサービスを分離するために VPS1 に追加の IP アドレスを割り当てなければならなくなったとします。129.42.0.0/29 サブネットから追加のアドレスを割り当てることも確かに可能ですが、このサブネットはサービスのためではなく VM をオンラインにするためにのみ使用したいと考えています。次の 2 つの選択肢があります。(1) 別のポータブル・サブネットを購入する (2) 静的サブネットを購入する。[サブネットについて](/docs/infrastructure/subnets?topic=subnets-about-subnets-and-ips)に記載しているポータブル・サブネットと静的サブネットの相違点の説明を思い出してください。ポータブル・サブネットには柔軟性がありますが、すべての IP アドレスを利用できるわけではありません。IP アドレスを 4 つ追加したいだけであれば、静的サブネットを購入するというのが効率的な選択肢になります。この方法を試してみましょう。

静的サブネットを購入し、129.42.0.100/30 を受け取りました。購入の際に、129.42.0.3 (このシナリオの VPS1) への経路を設定します。これにより、4 つの IP アドレスすべてが、129.42.0.3 に対応するサーバー (当然ですが、これは現在は VPS1 です) で使用できるようになります。ただし、いつでも 129.42.0.3 を VPS2 に移して、129.42.0.100/30 の 4 つの新しい IP アドレスを移行先から利用することができます。では、もう一度 IP アドレスの使用状況について見てみましょう。

129.42.0.0/29 - ポータブル・セカンダリー・サブネット
```
129.42.0.0 – ネットワーク
129.42.0.1 – ゲートウェイ
129.42.0.2 –
129.42.0.3 – VPS1
129.42.0.4 –
129.42.0.5 – VPS2
129.42.0.6 –
129.42.0.7 – ブロードキャスト
```

129.42.0.100/30 - 静的セカンダリー・サブネット
```
129.42.0.100 – 129.42.0.3 (VPS1)
129.42.0.101 – 129.42.0.3 (VPS1)
129.42.0.102 – 129.42.0.3 (VPS1)
129.42.0.103 – 129.42.0.3 (VPS1)
```

要約すると、ポータブル・サブネットを使用してすべての仮想マシン・ホストに IP アドレスを提供してから、静的サブネットを使用して 1 つの仮想マシンに追加の IP アドレスを提供しました。最初のポータブル・サブネットからアドレスを使用することも、単に別のポータブル・サブネットを追加することも間違いではありません。このシナリオから、ポータブル・サブネットの IP アドレスに静的サブネットをルーティングすることが、単に可能というだけでなく、実際に効率的で便利な方法であるということを理解していただけたと思います。
