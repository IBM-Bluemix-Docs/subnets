---
copyright:
  years: 1994, 2017, 2018, 2019
lastupdated: "2018-02-28"

keywords: Ms IP addresses, Use Secondary Subnets, own virtual machines

subcollection: subnets

---
{:shortdesc: .shortdesc}
{:new_window: target="_blank"}

# 在自托管 VM 上使用辅助子网
{:#use-secondary-subnets-self-hosted-vms}

如果托管自己的虚拟机，并希望这些虚拟机成为 {{site.data.keyword.BluSoftlayer_notm}} 网络上的一等公民，那么需要利用**辅助子网**。我们将讨论使用一个或多个虚拟机主机提供 VM IP 地址的灵活方式，而无论是否参与集群配置。

在整个场景中，请参阅[关于子网](/docs/infrastructure/subnets?topic=subnets-about-subnets-and-ips)以了解有关描述的子网类型的更多详细信息。

假设您有两台裸机服务器，称为 `aunt` 和 `uncle`。它们都将托管您自己的虚拟机，并且每个都已从**主子网**分配了自己的 IP 地址。您需要将额外的 IP 地址用于虚拟机。您可以使用任何类型的辅助子网来实现此需求，但是建议使用**可移植辅助子网**作为 VM 使用的地址的源。可移植子网为 `aunt` 和 `uncle` 提供对子网所定义的 IP 地址的访问权。通过此方式，您可以在两台服务器之间共享这些 IP 地址，并且如果将迁移技术用于 VM，那么可以无缝地在这些服务器之间传输 VM。

现在，假设您已创建两个虚拟机 `VPS1` 和 `VPS2`，购买了可移植子网 129.42.0.0/29，并将其中的两个地址分配给这些虚拟机。IP 地址使用情况下将类似于以下示例：

129.42.0.0/29 - 可移植辅助子网
```
129.42.0.0 – Network
129.42.0.1 – Gateway
129.42.0.2 –
129.42.0.3 – VPS1
129.42.0.4 –
129.42.0.5 – VPS2
129.42.0.6 –
129.42.0.7 – Broadcast
```

现在，假设您想要 VPS1 具有更多 IP 地址来隔离它提供的服务。您完全可以从 129.42.0.0/29 子网分配更多地址，但是您可能只希望将该子网用于使 VM 联机，而不用于其服务。您有两个选项：1) 购买另一个可移植子网，2) 购买静态子网。如果您还记得[关于子网](/docs/infrastructure/subnets?topic=subnets-about-subnets-and-ips)中可移植与静态子网的描述，您就知道虽然可移植子网提供灵活性，但是它们也不会允许您访问所有 IP 地址。例如，如果仅需要 4 个额外的 IP 地址，那么购买静态子网是一个比较高效的选项。让我们试一下。

购买静态子网并收到 129.42.0.100/30。在购买期间，您将其路由到 129.42.0.3 或 VPS1（在此场景中）。执行此操作将为您提供所有 4 个 IP 地址以供在响应 129.42.0.3（同样，这在当前为 VPS1）的任何服务器上使用，但是您可以随时将 129.42.0.3 传输到 VPS2，并且来自 129.42.0.100/30 的这四个新的 IP 地址也将一起传输！现在让我们再次查看 IP 地址使用情况：

129.42.0.0/29 - 可移植辅助子网
```
129.42.0.0 – Network
129.42.0.1 – Gateway
129.42.0.2 –
129.42.0.3 – VPS1
129.42.0.4 –
129.42.0.5 – VPS2
129.42.0.6 –
129.42.0.7 – Broadcast
```

129.42.0.100/30 - 静态辅助子网
```
129.42.0.100 – 129.42.0.3 (aka VPS1)
129.42.0.101 – 129.42.0.3 (aka VPS1)
129.42.0.102 – 129.42.0.3 (aka VPS1)
129.42.0.103 – 129.42.0.3 (aka VPS1)
```

回顾一下，我们使用了可移植子网以使 IP 地址可用于所有虚拟机主机，然后使用静态子网将额外的 IP 地址提供给虚拟机。您肯定使用了源自原始可移植子网中的地址，或者只是添加了另一个可移植子网。我们希望此场景能够说明，不仅可以将静态子网路由到可移植子网上的 IP 地址，而且这样做实际上非常高效且有用。
